---
title: "GRAAL : Classification automatique de nomenclatures statistiques par approche agentique"
subtitle: "Graph-based Research with Agents for Automatic Labelling"
author: "BPSS - SSPlab"
institute: "INSEE - Innovation Unit"
date: today
date-format: "DD MMMM YYYY"
lang: fr
format:
  revealjs:
    theme: [default, custom.scss]
    logo: images/logo-insee.png
    footer: "Corps techniques de l'√âtat - 2025"
    slide-number: c/t
    show-slide-number: all
    width: 1920
    height: 1080
    margin: 0.05
    center: true
    navigation-mode: vertical
    controls-layout: bottom-right
    controls-tutorial: false
    transition: slide
    transition-speed: default
    background-transition: fade
    incremental: false
    fig-align: center
    fig-cap-location: bottom
    toc: false
    embed-resources: true
execute:
  echo: false
  warning: false
  message: false
---

## Sommaire {.smaller}

:::: {.columns}

::: {.column width="30%"}
### 1Ô∏è‚É£ Contexte
Classification statistique √† l'INSEE
:::

::: {.column width="30%"}
### 2Ô∏è‚É£ Solution GRAAL
Architecture multi-agents
:::

::: {.column width="30%"}
### 3Ô∏è‚É£ R√©sultats
Performances et perspectives
:::

::::

# üìä Contexte {background-color="#003366"}

## L'enjeu de la classification statistique
```{mermaid}
%%{init: {'theme':'base', 'themeVariables': { 'fontSize': '20px'}}}%%
graph LR
    subgraph Inputs["üì• Donn√©es entrantes"]
        A[12M entreprises/an]
        B[5M produits]
        C[8M transactions]
    end
    
    subgraph Process["‚öôÔ∏è Classification"]
        D[Codification manuelle]
        E[Temps: 3-5 min/item]
        F[Co√ªt: 15‚Ç¨/item]
    end
    
    subgraph Output["üì§ Production"]
        G[Statistiques nationales]
        H[Eurostat]
        I[Comptes nationaux]
    end
    
    A --> D
    B --> D
    C --> D
    D --> G
    E --> G
    F --> G
    G --> H
    G --> I
    
    style Inputs fill:#e3f2fd
    style Process fill:#fff3e0
    style Output fill:#e8f5e9
```

## Les nomenclatures INSEE

:::: {.columns}

::: {.column width="50%"}
```{mermaid}
%%{init: {'theme':'neutral'}}%%
graph TD
    NACE["üìÅ NACE<br/>732 codes"]
    NACE --> S1["Section A-U<br/>21 sections"]
    S1 --> D1["Divisions<br/>88 divisions"]
    D1 --> G1["Groupes<br/>272 groupes"]
    G1 --> C1["Classes<br/>615 classes"]
    C1 --> SC["Sous-classes<br/>732 codes finaux"]
    
    style NACE fill:#1976d2,color:#fff
    style SC fill:#ff6b6b,color:#fff
```
:::

::: {.column width="50%"}
### Exemples concrets

| Niveau | Code | Description |
|--------|------|-------------|
| **Section** | C | Industrie manufacturi√®re |
| **Division** | 10 | Industries alimentaires |
| **Groupe** | 10.7 | Boulangerie-p√¢tisserie |
| **Classe** | 10.71 | Fabrication pain |
| **Sous-classe** | 10.71Z | Boulangerie et p√¢tisserie |
:::

::::

## Volume et complexit√©
```{mermaid}
%%{init: {'theme':'base', 'themeVariables': { 'fontSize': '18px'}}}%%
pie title "R√©partition des 12M classifications annuelles"
    "Commerce (G)" : 35
    "Services (M-N)" : 25
    "Construction (F)" : 15
    "Industrie (C)" : 10
    "Transport (H)" : 8
    "Autres" : 7
```

::: {.callout-important}
**D√©fi** : 85% des cas n√©cessitent une expertise m√©tier approfondie
:::

# üî¥ Probl√©matique {background-color="#8B0000"}

## Limites des approches actuelles
```{mermaid}
%%{init: {'theme':'base'}}%%
timeline
    title √âvolution des m√©thodes de classification

    1990-2000 : R√®gles manuelles
                : 100% humain
                : Co√ªt tr√®s √©lev√©
                : Excellente qualit√©

    2000-2010 : Syst√®mes experts
                : R√®gles if/then
                : Maintenance complexe
                : Qualit√© variable

    2010-2020 : Machine Learning
                : Random Forest, SVM
                : Besoin donn√©es annot√©es
                : 75-80% pr√©cision

    2020-2023 : Deep Learning
                : BERT, Transformers  
                : Bo√Æte noire
                : 85% pr√©cision

    2023-2025 : LLMs directs
                : GPT, Claude
                : Hallucinations
                : Inconsistance
```

## Pourquoi les LLMs seuls ne suffisent pas

:::: {.columns}

::: {.column width="50%"}
### ‚ùå Probl√®mes identifi√©s
```{mermaid}
%%{init: {'theme':'base'}}%%
graph TD
    LLM[LLM Standard]
    
    P1[üî¥ Context Window<br/>Max 8K tokens]
    P2[üî¥ Hallucinations<br/>Codes invent√©s]
    P3[üî¥ Inconsistance<br/>R√©sultats variables]
    P4[üî¥ Bo√Æte noire<br/>Pas d'explication]
    
    LLM --> P1
    LLM --> P2
    LLM --> P3
    LLM --> P4
    
    style P1 fill:#ffcdd2
    style P2 fill:#ffcdd2
    style P3 fill:#ffcdd2
    style P4 fill:#ffcdd2
```
:::

::: {.column width="50%"}
### üìä Impact sur la qualit√©
```{mermaid}
%%{init: {'theme':'base'}}%%
graph LR
    subgraph Tentative["Test avec GPT-4"]
        A[1000 entreprises]
        B[3 runs identiques]
        C[27% de variance]
        D[15% codes invalides]
    end
    
    A --> B
    B --> C
    B --> D
    
    style Tentative fill:#ffe0e0
```

::: {.callout-note}
**Constat** : Les LLMs g√©n√®rent des codes diff√©rents √† chaque ex√©cution pour la m√™me entreprise
:::
:::

::::

## Le co√ªt de l'erreur
```{mermaid}
%%{init: {'theme':'base', 'themeVariables': { 'fontSize': '16px'}}}%%
flowchart LR
    subgraph Impact["Impact d'une mauvaise classification"]
        E1[Erreur codage]
        E2[Stats fauss√©es]
        E3[Politiques publiques]
        E4[Allocations budg√©taires]
        E5[Impact √©conomique]
        
        E1 --> E2
        E2 --> E3
        E3 --> E4
        E4 --> E5
    end
    
    style E1 fill:#ff6b6b
    style E5 fill:#d32f2f,color:#fff
```

# üíö Solution GRAAL {background-color="#2E7D32"}

## Vue d'ensemble de l'architecture
```{mermaid}
%%{init: {'theme':'base', 'themeVariables': { 'fontSize': '18px', 'primaryColor':'#2E7D32'}}}%%
graph TB
    Input["üè¢ Description entreprise<br/>'Boulangerie artisanale'"]
    
    subgraph GRAAL["ü§ñ Framework GRAAL"]
        direction TB
        
        subgraph Agents["Agents Sp√©cialis√©s"]
            GA["üîç Graph Navigator<br/>Parcours hi√©rarchique"]
            RA["üìö RAG Agent<br/>Enrichissement contextuel"]
            EA["‚úÖ Validation Agent<br/>V√©rification coh√©rence"]
        end
        
        subgraph KG["üß† Knowledge Graph Neo4j"]
            N1[("732 codes NACE")]
            N2[("Relations hi√©rarchiques")]
            N3[("Descriptions enrichies")]
            N4[("Exemples m√©tier")]
        end
        
        GA <--> KG
        RA <--> KG
        EA <--> KG
        
        GA --> RA
        RA --> EA
    end
    
    Output["‚úÖ Code: 10.71Z<br/>üìä Confiance: 94%<br/>üìù Justification d√©taill√©e"]
    
    Input --> GA
    EA --> Output
    
    style GRAAL fill:#e8f5e9
    style Agents fill:#c8e6c9
    style KG fill:#fff9c4
    style Input fill:#e1f5fe
    style Output fill:#c8e6c9
```

## Navigation intelligente dans le graphe

:::: {.columns}

::: {.column width="60%"}
```{mermaid}
%%{init: {'theme':'base'}}%%
stateDiagram-v2
    [*] --> Analyse
    Analyse --> Section: Mots-cl√©s d√©tect√©s
    
    Section --> Division: Navigation descendante
    Division --> Groupe: Affinage contexte
    Groupe --> Classe: Sp√©cialisation
    Classe --> SousClasse: Validation finale
    
    SousClasse --> [*]: Code attribu√©
    
    Section --> Backtrack: Ambigu√Øt√©
    Backtrack --> Section: Nouvelle branche
```
:::

::: {.column width="40%"}
### üéØ Strat√©gie de parcours

1. **Extraction features** 
   - Analyse s√©mantique
   - D√©tection activit√©s

2. **Parcours guid√©**
   - Top-down d'abord
   - Backtracking si besoin

3. **Validation continue**
   - Coh√©rence hi√©rarchique
   - Score de confiance
:::

::::

## Exemple de navigation
```{mermaid}
%%{init: {'theme':'forest', 'themeVariables': { 'fontSize': '16px'}}}%%
graph TD
    Start["üè¢ 'Boulangerie artisanale<br/>avec salon de th√©'"]
    
    Start --> Q1{Activit√© principale?}
    Q1 -->|Production| C["Section C<br/>Industrie"]
    Q1 -->|Commerce| G["Section G<br/>Commerce"]
    
    C --> Q2{Type production?}
    Q2 -->|Alimentaire| D10["Division 10<br/>Prod. alimentaire"]
    
    D10 --> Q3{Sp√©cialit√©?}
    Q3 -->|Boulangerie| G107["Groupe 10.7<br/>Boulangerie"]
    
    G107 --> Q4{Vente directe?}
    Q4 -->|Oui| C1071["Classe 10.71<br/>Fabrication pain"]
    
    C1071 --> Final["‚úÖ 10.71Z<br/>Confiance: 94%"]
    
    style Start fill:#e1f5fe
    style Final fill:#c8e6c9
    style C fill:#fff9c4
    style D10 fill:#fff9c4
    style G107 fill:#fff9c4
    style C1071 fill:#fff9c4
```

## Comparaison des approches
```{mermaid}
%%{init: {'theme':'base'}}%%
graph LR
    subgraph Traditionnel["‚ùå Approche LLM classique"]
        T1["Prompt avec<br/>732 codes"]
        T2["Token limit!<br/>√âchec"]
        T3["Ou: hallucination<br/>Code invent√©"]
        T1 --> T2
        T1 --> T3
    end
    
    subgraph GRAAL["‚úÖ Approche GRAAL"]
        G1["Navigation<br/>hi√©rarchique"]
        G2["21‚Üí88‚Üí272<br/>‚Üí615‚Üí732"]
        G3["Chemin trac√©<br/>Code valide"]
        G1 --> G2
        G2 --> G3
    end
    
    style Traditionnel fill:#ffebee
    style GRAAL fill:#e8f5e9
```

# üìà R√©sultats {background-color="#6A1B9A"}

## Performances compar√©es
```{mermaid}
%%{init: {'theme':'base'}}%%
graph TD
    subgraph M√©triques["√âvaluation sur 10,000 entreprises"]
        
        subgraph Pr√©cision["üéØ Pr√©cision"]
            P1[R√®gles: 75%]
            P2[ML: 82%]
            P3[LLM: 85%]
            P4[GRAAL: 92%]
        end
        
        subgraph Consistency["üîÑ Coh√©rence"]
            C1[R√®gles: 100%]
            C2[ML: 85%]
            C3[LLM: 73%]
            C4[GRAAL: 98%]
        end
        
        subgraph Explainability["üìù Explicabilit√©"]
            E1[R√®gles: 100%]
            E2[ML: 30%]
            E3[LLM: 40%]
            E4[GRAAL: 100%]
        end
    end
    
    style P4 fill:#4caf50,color:#fff
    style C4 fill:#4caf50,color:#fff
    style E4 fill:#4caf50,color:#fff
```

## Matrice de confusion - Sections principales
```{mermaid}
%%{init: {'theme':'base'}}%%
heatmap
    title "Matrice de confusion GRAAL vs R√©alit√©"
    x-axis ["Agriculture", "Industrie", "Construction", "Commerce", "Services"]
    y-axis ["Agriculture", "Industrie", "Construction", "Commerce", "Services"]
    
    [[95, 2, 0, 1, 2],
     [3, 91, 2, 2, 2],
     [1, 2, 93, 3, 1],
     [2, 1, 2, 89, 6],
     [1, 2, 1, 5, 91]]
```

## Gain de productivit√©

:::: {.columns}

::: {.column width="50%"}
### ‚è±Ô∏è Temps de traitement
```{mermaid}
%%{init: {'theme':'base'}}%%
graph TD
    subgraph Avant["Avant GRAAL"]
        A1[3-5 min/entreprise]
        A2[100% manuel]
        A3[15‚Ç¨/classification]
    end
    
    subgraph Apres["Avec GRAAL"]
        B1[450ms/entreprise]
        B2[92% automatique]
        B3[0.10‚Ç¨/classification]
    end
    
    style Avant fill:#ffcdd2
    style Apres fill:#c8e6c9
```
:::

::: {.column width="50%"}
### üí∞ Impact √©conomique annuel
```{mermaid}
%%{init: {'theme':'base'}}%%
pie title "√âconomies r√©alis√©es"
    "Temps agents √©conomis√©" : 45
    "R√©duction erreurs" : 25
    "Am√©lioration qualit√©" : 20
    "Formation r√©duite" : 10
```

**Estimation : 2.5M‚Ç¨ d'√©conomies/an**
:::

::::

## Analyse qualitative
```{mermaid}
%%{init: {'theme':'base', 'themeVariables': {'fontSize': '18px'}}}%%
radar
    title "√âvaluation multi-crit√®res"
    "Pr√©cision": 92
    "Rapidit√©": 95
    "Coh√©rence": 98
    "Explicabilit√©": 100
    "Scalabilit√©": 90
    "Maintenance": 85
    "Co√ªt": 95
```

## Cas d'usage r√©ussis

:::: {.columns}

::: {.column width="33%"}
### üè≠ Industrie
- Multi-activit√©s complexes
- Distinction production/service
- **Pr√©cision : 91%**
:::

::: {.column width="33%"}
### üõçÔ∏è Commerce
- Vente physique vs en ligne
- Gros vs d√©tail
- **Pr√©cision : 89%**
:::

::: {.column width="33%"}
### üèóÔ∏è Construction
- M√©tiers sp√©cialis√©s
- Travaux publics vs b√¢timent
- **Pr√©cision : 93%**
:::

::::

# üîÆ Perspectives {background-color="#FF6B35"}

## Roadmap 2025-2026
```{mermaid}
%%{init: {'theme':'base'}}%%
gantt
    title Planning de d√©veloppement GRAAL
    dateFormat YYYY-MM
    section Phase 1
    Tests utilisateurs           :2025-01, 2025-02
    Optimisation performance     :2025-02, 2025-03
    API Production              :2025-03, 2025-04
    
    section Phase 2
    Extension COICOP            :2025-04, 2025-06
    Support multilingue         :2025-05, 2025-07
    Interface web               :2025-06, 2025-08
    
    section Phase 3
    D√©ploiement INSEE          :2025-09, 2025-12
    Formation agents           :2025-10, 2025-11
    
    section Phase 4
    Open source               :2026-01, 2026-03
    Collaboration Eurostat    :2026-02, 2026-06
```

## Extensions pr√©vues
```{mermaid}
%%{init: {'theme':'neutral'}}%%
mindmap
  root((GRAAL))
    Nomenclatures
      NACE ‚úÖ
      COICOP üöß
      PCS üìÖ
      NAF üìÖ
    Langues
      Fran√ßais ‚úÖ
      Anglais üöß
      Allemand üìÖ
      Italien üìÖ
    Int√©grations
      API REST ‚úÖ
      Batch üöß
      Temps r√©el üìÖ
      SI INSEE üìÖ
    IA
      LLM optimis√©s üöß
      Active Learning üìÖ
      Auto-correction üìÖ
```

## Vision √† long terme

:::: {.columns}

::: {.column width="50%"}
### üéØ Objectifs 2027

- **Couverture** : 100% des nomenclatures INSEE
- **Pr√©cision** : >95% sur tous les domaines
- **Adoption** : Standard europ√©en
- **Open Source** : Communaut√© active
:::

::: {.column width="50%"}
### üåç Impact attendu
```{mermaid}
%%{init: {'theme':'base'}}%%
graph TD
    GRAAL[GRAAL Open Source]
    
    I1[INSEE]
    I2[Eurostat]
    I3[ONS UK]
    I4[Destatis]
    I5[ISTAT]
    
    GRAAL --> I1
    GRAAL --> I2
    GRAAL --> I3
    GRAAL --> I4
    GRAAL --> I5
    
    style GRAAL fill:#4caf50,color:#fff
```
:::

::::

# Conclusion

## GRAAL : Une r√©volution pour la statistique publique
```{mermaid}
%%{init: {'theme':'base', 'themeVariables': {'fontSize': '20px'}}}%%
graph LR
    subgraph Avant["üî¥ Avant"]
        A1[Manuel]
        A2[Co√ªteux]
        A3[Lent]
        A4[Erreurs]
    end
    
    subgraph GRAAL["üíö Avec GRAAL"]
        B1[Automatique]
        B2[√âconomique]
        B3[Rapide]
        B4[Fiable]
    end
    
    Avant -->|Innovation| GRAAL
    
    style Avant fill:#ffcdd2
    style GRAAL fill:#c8e6c9
```

::: {.incremental}
- ‚úÖ **Solution op√©rationnelle** valid√©e sur donn√©es r√©elles
- ‚úÖ **Gain de productivit√©** x400 sur le temps de traitement  
- ‚úÖ **Qualit√© maintenue** avec 92% de pr√©cision
- ‚úÖ **Tra√ßabilit√© compl√®te** pour l'audit
- ‚úÖ **√âvolutif** vers d'autres nomenclatures
:::

## {background-image="images/merci.jpg" background-size="cover" background-opacity="0.3"}

::: {style="text-align: center; font-size: 2em; margin-top: 20%;"}
# Merci pour votre attention

### Questions ?

üìß theo.ferry@insee.fr

üîó [github.com/InseeFrLab/codif-ape-graph-rag](https://github.com/InseeFrLab/codif-ape-graph-rag)
:::

## Annexes {visibility="uncounted"}

### D√©tails techniques

:::: {.columns}
::: {.column width="50%"}
**Infrastructure**
- Python 3.11
- Neo4j 5.0
- LangChain/LangGraph
- SSPCloud/Onyxia
:::

::: {.column width="50%"}
**Mod√®les utilis√©s**
- Embeddings : CamemBERT
- LLM : Llama 3.1 70B
- Graph : Neo4j GDS
:::
::::

### M√©triques d√©taill√©es

| M√©trique | Valeur | D√©tail |
|----------|--------|--------|
| Pr√©cision@1 | 92% | Top choice correct |
| Pr√©cision@3 | 97% | Dans les 3 premiers |
| Rappel | 89% | Codes trouv√©s |
| F1-Score | 0.90 | √âquilibre P/R |
| MRR | 0.94 | Mean Reciprocal Rank |